# Changelog for System Maintenance Script

## Version 1.5.0 - August 15, 2025
- Added `contig` command to defragment the Master File Table (MFT) on a user-specified drive (default: C:).
- Implemented drive letter prompt with validation for the `contig` command.
- Added check for `contig` availability in PATH, with instructions to download if missing.
- Updated version to 1.5.0 to reflect the new command.
- Updated `readme.md` to document the `contig` command and its requirements.
- Retained all previous functionality: hostname/date log naming, log rotation, Yes/No prompts, optional `/restorehealth` source, and analysis of DISM.log, CBS.log, and CHKDSK Event Log.

## Version 1.4.0 - August 15, 2025
- Modified log file naming to include hostname and date (format: `SystemMaintenanceLog_HOSTNAME_YYYYMMDD.txt`).
- Implemented log rotation to append a numeric suffix (e.g., `_1`, `_2`) if a log file already exists.
- Updated version to 1.4.0 to reflect log naming and rotation changes.
- Updated `readme.md` to document new log file naming and rotation behavior.
- Retained all previous functionality: verbose comments, Yes/No prompts, logging, optional `/restorehealth` source, and analysis of DISM.log, CBS.log, and CHKDSK Event Log.

## Version 1.3.0 - August 15, 2025
- Added support for an optional repair source for `dism /online /cleanup-image /restorehealth` via `$repairSource` variable.
- Updated `/restorehealth` command to dynamically include `/source` if specified, defaulting to Windows Update otherwise.
- Incremented version to reflect new functionality.
- Updated `readme.md` to document the new repair source option.
- Retained all previous functionality: verbose comments, Yes/No prompts, logging, and analysis of DISM.log, CBS.log, and CHKDSK Event Log.

## Version 1.2.0 - August 15, 2025
- Added verbose comments throughout the script for better readability and maintenance.
- Introduced versioning with version number (1.2.0) and last modified date in script header.
- Added changelog.txt to track version history.
- Added readme.md for GitHub documentation with usage instructions and requirements.
- Retained all previous functionality:
  - Yes/No prompts with default "Yes" for all commands and log analysis.
  - Logging of command outputs to SystemMaintenanceLog.txt.
  - Analysis of DISM.log, CBS.log, and CHKDSK Event Log for errors and repairs.
  - Summary of errors and repairs displayed to user and logged.

## Version 1.1.0 - August 14, 2025
- Added Event Log analysis for CHKDSK (Wininit, Event ID 1001) to count errors and repairs.
- Limited CHKDSK Event Log analysis to last 24 hours and max 10 events for performance.
- Updated log analysis section to include CHKDSK results in summary.
- Improved error handling for Event Log access.

## Version 1.0.0 - August 13, 2025
- Initial release.
- Included DISM commands: CheckHealth, ScanHealth, RestoreHealth, AnalyzeComponentStore, StartComponentCleanup.
- Added SFC /scannow and CHKDSK /scan c: commands.
- Implemented Yes/No prompts with default "Yes" for each command.
- Added logging of command outputs to SystemMaintenanceLog.txt.
- Added analysis of DISM.log and CBS.log for errors and repairs with summary output.