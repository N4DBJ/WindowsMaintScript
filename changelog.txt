# Changelog
All notable changes to the WindowsMaintScript project will be documented in this file.

## [2.5.5] - 2025-08-16
### Added
- Initial System State Check section to detect pending Windows Updates (via `PSWindowsUpdate` module or `Get-HotFix` fallback) and pending restarts (Windows Update, Component-Based Servicing, Pending File Rename Operations, SCCM client).
- Prompts user to restart if pending updates or restarts are detected (default "Y"). If declined, proceeds with warning that results may be affected.
- Logs pending updates (count and details) and restart sources.
- Updated Log Analysis section to include pending updates and restarts in summary.
- Moved pending reboot check from Memory and Update Checks to Initial System State Check.

## [2.5.4] - 2025-08-16
### Added
- Real-time DISM progress display on console using `Write-Progress` for percentage updates (e.g., `[========== 18.1% ]`) during `checkhealth`, `scanhealth`, `restorehealth`, `AnalyzeComponentStore`, and `StartComponentCleanup`.
- Cleaned up DISM log output to exclude repetitive progress lines (e.g., `[========== 18.1% ]`), logging only the final progress percentage (e.g., `[=========== 100.0% ]`) and significant messages (e.g., "The operation completed successfully").

## [2.5.3] - 2025-08-16
### Added
- Added checks for Windows Defender service (WinDefend) status and third-party antivirus software before running `Start-MpScan` to prevent `CimException` (0x800106ba).
- Attempts to start WinDefend if stopped and logs the outcome.
- Checks for third-party antivirus via `Get-CimInstance -Namespace root/SecurityCenter2 -ClassName AntiVirusProduct`.
- Provides recommendations if scan fails (e.g., check Defender status, run `MpCmdRun -SignatureUpdate`, repair system with DISM/SFC).
- Added Defender error tracking in